---
title: SE(3) 等变的生成扩散模型
date: 2024-04-20
---

在蛋白质结构生成中遇到的一篇数学很硬的文献，为了后续的研究需要，学习一下SE(3)等变的生成扩散模型。

## 1 扩散模型初步

之前组会报告准备过一次关于一般扩散模型的内容[扩散模型简介](./扩散模型简介.pdf)，但是模型不具有SE(3)等变性质。

## 2 什么是 SE(3)？为什么需要SE(3)？
###   2.1. SE(3) 的定义  

SE(3)（Special Euclidean group in 3D，即三维特殊欧几里得群），它包括旋转和平移两部分。数学上，SE(3) 定义为：

\[
SE(3) = \{(R, x) \mid R \in SO(3), x \in \mathbb{R}^3\}
\]

其中：
- \( R \in SO(3) \) 是一个 \( 3 \times 3 \) 正交矩阵（即 \( R^\top R = I \)）且 \(\det(R) = 1\)，表示三维旋转。
- \( x \in \mathbb{R}^3 \) 是一个三维平移向量，表示刚体在三维空间的平移。

SE(3) 的群运算是：

\[
(R_1, x_1) \cdot (R_2, x_2) = (R_1 R_2, R_1 x_2 + x_1)
\]

它表示一个刚体变换 \( (R_2, x_2) \) 作用后，再应用变换 \( (R_1, x_1) \) 的结果。

###   2.2. 为什么需要 SE(3)？  

涉及三维刚体的问题中，特别是在分子模拟、机器人学、计算机视觉等领域，物体的状态不仅仅是一个位置（平移），还包括方向（旋转）。SE(3) 提供了一个数学框架，使得我们可以在同一个空间中处理这些信息。
 
在 SE(3) 空间上进行建模的一个关键优势是，它能够保持物理和几何的不变性。具体来说：
- 在蛋白质建模中，蛋白质的结构和功能通常仅取决于其相对构象，而不是其绝对位置或方向。因此，我们希望构造的模型具有对称性，不会因坐标选取不同而导致结果不同。
- 在机器人学中，机器人手臂、自动驾驶汽车、无人机的姿态（pose）通常在 SE(3) 上进行建模，以便在不同的参考系之间转换。
- 在计算机视觉中，物体识别和跟踪通常需要对旋转和平移具有鲁棒性，因此 SE(3) 变换在 3D 目标检测和姿态估计任务中十分重要。
### 2.3. 蛋白质中的 SE(3) 是什么？ 
在蛋白质结构建模中，平移通常指的是 Cα 的平移 ，而旋转则涉及整个框架（frame）的旋转。

每个氨基酸残基由一组固定的主链原子（N、Cα、C、O）组成，这些原子在理想化情况下保持相对固定的几何关系。旋转的核心是这个刚性框架（frame）的方向，即以 Cα 作为中心的旋转。

蛋白质的主链是通过共价键连接的，每个残基的 N、Cα、C 具有固定的几何关系（键长、键角）。因此，在建模过程中，我们可以将每个残基视为一个刚体，即只允许其进行整体的刚体旋转，而不改变内部键长和键角。

数学上，我们用一个  SE(3) 变换  \( T = (R, x) \) 来表示残基的空间位姿：
-  \( x \in \mathbb{R}^3 \) ：表示 Cα 的平移位置（即氨基酸的中心位置）。
-  \( R \in SO(3) \) ：表示该残基在三维空间中的 方向 ，即 N、Cα、C 三个原子构成的刚体的旋转。

由于 SE(3) 变换是作用在刚体上的，我们需要一个合适的坐标系来描述残基的方向。通常，我们使用Gram-Schmidt 正交化来构造一个正交基，以描述 N、Cα、C 的相对方向，从而定义\(R\)。

如果我们用 \( T_n = (R_n, x_n) \) 表示第 \( n \) 个残基的 pose，那么：
\[
[N_n, C_n, (Cα)_n] = T_n \cdot [N^*, C^*, Cα^*],
\]
其中：\( [N^*, C^*, Cα^*] \) 是理想化残基的标准坐标。\( T_n = (R_n, x_n) \) 作用在这些坐标上，给出第 \( n \) 个残基在三维空间中的实际位置。

